"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[708],{1708:function(e,t,a){a.r(t),a.d(t,{default:function(){return le}});var l=a(3396),r=(a(7658),a(4870)),n=a(7139),o=a(7709),i=a.n(o),s=a(3477),c=a(7064);const d=["order"],p=(0,l._)("div",{id:"map"},[(0,l._)("div",{id:"popUp",style:{width:"100px",height:"100px","z-index":"99",position:"relative"}})],-1),v=[p];var u=(0,l.aZ)({__name:"centerMap",props:{mapId:{},order:{},projectId:{}},setup(e){const t=e,a=new s.Nv,r=[[0,4,3],[.5,4,2.5],[1,4,2],[1.5,4,1.5],[2,4,1],[2.5,4,.5],[3,4,0],[0,.5,3,3.5],[0,1,3,3],[0,1.5,3,2.5],[0,2,3,2],[0,2.5,3,1.5],[0,3,3,1],[0,3.5,3,.5]];let n=0;return(0,l.bv)((async()=>{i().accessToken="pk.eyJ1Ijoiam9obm55dCIsImEiOiJja2xxNXplNjYwNnhzMm5uYTJtdHVlbTByIn0.f1GfZbFLWjiEayI6hb_Qvg";const e=document.getElementById("map");e.style.background=c.k.background;const l=new(i().Map)({container:"map",style:c.k.styleJson,center:[120.861,31.8813],zoom:11.16,pitch:15,bearing:20});let o=await a.prepareFloatLineDataSource(t.projectId),s=await a.prepareSectionDataSource(t.projectId);function d(e){const t=Math.floor(e/100%r.length);if(t!==n){for(let e=0;e<a.floatPtNum;e++)l.setPaintProperty("floatLine"+e+"-dashed","line-dasharray",r[n]);n=t}requestAnimationFrame(d)}l.loaded()?(a.addSectionLayers(l,s),a.addFloatLineLayers(l,o),d(0)):l.on("load",(()=>{a.addSectionLayers(l,s),a.addFloatLineLayers(l,o),d(0)}))})),(e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"scene-map-wrapper",order:e.$props.order},v,8,d))}});const y=u;var h=y,w=a(3824),_=a(9043);const I=["styleId","order","index"],g=["index"];var f=(0,l.aZ)({__name:"chartContainer",props:{chartId:{},order:{},styleType:{},projectId:{}},setup(e,{expose:t}){const a=e;let o=(0,r.Vh)(a,"projectId");const i=(0,r.iH)(a.chartId),c=(0,r.iH)(a.styleType),d=(0,r.iH)(),p=(0,r.iH)(a.order);let v=(0,r.iH)(a.projectId);const u=new s.nT(+i.value),y=()=>{console.log(o.value)};let h=-1,w=(0,r.iH)(!0),f=(0,r.iH)(!1),m=()=>{w.value=!w.value};const b=async(e,t)=>{const a=await u.buildChartOption(t);function l(){e.setOption(a[j+1]),j=(j+1)%(a.length-1)}let r=async()=>{u.dynamicIndex+=1;const l=await u.buildChartOption(t);e.clear();for(let e in l)a[e]=l[e];e.setOption(a)};Array.isArray(a)?(f.value=!0,e.setOption(a[0]),h=setInterval(l,4e3),m=()=>{w.value=!w.value,-1!=h?(clearInterval(h),h=-1):h=setInterval(l,4e3)}):(e.setOption(a),!0===u.isDynamic&&(f.value=!0,h=setInterval(r,4e3),m=()=>{w.value=!w.value,-1!=h?(clearInterval(h),h=-1):h=setInterval(r,4e3)}))};let H,j=0;return(0,l.bv)((async()=>{console.log("mounted"),H=_.S1(d.value),await b(H,v.value)})),(0,l.dl)((async()=>{console.log("activated"),await b(H,v.value)})),(0,l.se)((()=>{-1!=h&&clearInterval(h)})),(0,l.Ah)((()=>{-1!=h&&clearInterval(h)})),t({changeData:y}),(e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"chart-container",styleId:c.value,order:p.value,index:i.value},[(0,l._)("div",{ref_key:"chartDom",ref:d,class:"echart-container"},null,512),(0,r.SU)(f)?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,n.C_)(["play-button",{paused:(0,r.SU)(w)}]),index:i.value,onClick:t[0]||(t[0]=(...e)=>(0,r.SU)(m)&&(0,r.SU)(m)(...e))},null,10,g)):(0,l.kq)("",!0)],8,I))}}),m=a(89);const b=(0,m.Z)(f,[["__scopeId","data-v-484734cd"]]);var H=b;const j={class:"data-table-wrapper"},S={class:"table-title"};var k=(0,l.aZ)({__name:"dataTable",props:{projectId:{}},async setup(e,{expose:t}){let a,o;const i=e;console.log("table project id",i.projectId);const c=new s.nT(0);let d=([a,o]=(0,l.mv)((()=>c.buildChartOption(i.projectId))),a=await a,o(),a),p=(0,r.iH)({name:d["name"]+"表面流轨迹",tHead:["时间","X","Y","流速"],tBody:d["data"]});const v=(0,r.iH)(),u=(0,r.iH)();let y=()=>{let e=v.value?.tBodies[0].firstChild;v.value?.tBodies[0].removeChild(e),v.value?.tBodies[0].appendChild(e)},h=-1;const w=async e=>{clearInterval(h),d=await c.buildChartOption(e),p=(0,r.iH)({name:d["name"]+"表面流轨迹",tHead:["时间","X","Y","流速"],tBody:d["data"]}),h=setInterval(y,1e3)};return(0,l.bv)((()=>{h=setInterval(y,1e3)})),t({changeTableData:w}),(e,t)=>((0,l.wg)(),(0,l.iD)("div",j,[(0,l._)("div",S,(0,n.zw)((0,r.SU)(p).name),1),(0,l._)("table",{class:"tb-container",ref_key:"dataTable",ref:v},[(0,l._)("thead",null,[(0,l._)("tr",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(p).tHead,(e=>((0,l.wg)(),(0,l.iD)("th",{key:(0,r.SU)(p).tHead.indexOf(e)},[(0,l._)("h1",null,(0,n.zw)(e),1)])))),128))])]),(0,l._)("tbody",{ref_key:"tableBody",ref:u},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(p).tBody,(e=>((0,l.wg)(),(0,l.iD)("tr",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e,(e=>((0,l.wg)(),(0,l.iD)("td",null,(0,n.zw)(e),1)))),256))])))),256))],512)],512)]))}});const x=(0,m.Z)(k,[["__scopeId","data-v-5261eabd"]]);var U=x;const D=["styleId","order","index"],T={class:"double-chart-container"},C=["index"],O={name:"chartContainer"};var Z=(0,l.aZ)({...O,props:{chartId:{},order:{},styleType:{},projectId:{}},setup(e){const t=e,a=(0,r.iH)(t.chartId),o=(0,r.iH)(t.styleType),i=(0,r.iH)(t.order);let c=(0,r.iH)(t.projectId);const d=(0,r.iH)(),p=((0,r.iH)(),new s.nT(+a.value.substring(0,1)));let v,u=(0,r.iH)(!0),y=(0,r.iH)(!1),h=-1,w=()=>{u.value=!u.value},I=0;const g=async(e,t)=>{const a=await p.buildChartOption(t);function l(){e.setOption(a[I+1]),I=(I+1)%(a.length-1)}let r=async()=>{p.dynamicIndex+=1;const l=await p.buildChartOption(t);e.clear();for(let e in l)a[e]=l[e];e.setOption(a)};Array.isArray(a)?(y.value=!0,e.setOption(a[0]),h=setInterval(l,4e3),w=()=>{u.value=!u.value,-1!=h?(clearInterval(h),h=-1):h=setInterval(l,4e3)}):(e.setOption(a),!0===p.isDynamic&&(y.value=!0,h=setInterval(r,4e3),w=()=>{u.value=!u.value,-1!=h?(clearInterval(h),h=-1):h=setInterval(r,4e3)}))};return(0,l.bv)((async()=>{v=_.S1(d.value),await g(v,c.value)})),(0,l.dl)((async()=>{console.log("activated"),await g(v,c.value)})),(0,l.se)((()=>{-1!=h&&clearInterval(h)})),(0,l.Ah)((()=>{-1!=h&&clearInterval(h)})),(e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"part-container",styleId:o.value,order:i.value,index:a.value},[(0,l._)("div",T,[(0,l._)("div",{class:"table-container left",ref_key:"chartLeft",ref:d},[(0,l.Wm)(U,{"project-id":e.$props.projectId},null,8,["project-id"])],512),(0,l._)("div",{class:"chart right",ref_key:"chartLeft",ref:d},null,512)]),(0,r.SU)(y)?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,n.C_)(["play-button",{paused:(0,r.SU)(u)}]),index:a.value,onClick:t[0]||(t[0]=(...e)=>(0,r.SU)(w)&&(0,r.SU)(w)(...e))},null,10,C)):(0,l.kq)("",!0)],8,D))}});const L=(0,m.Z)(Z,[["__scopeId","data-v-48bb6023"]]);var z=L,A=a(26);const B=e=>((0,l.dD)("data-v-0ce8c526"),e=e(),(0,l.Cn)(),e),Y={class:"viewer-header"},N={class:"clock"},W={class:"time"},V={class:"title-text-content"},K=B((()=>(0,l._)("div",{class:"title-wrap-left"},[(0,l._)("svg",{class:"title-svg-left",x:"0",y:"0",width:"100%",height:"100%",viewBox:"0 0 600 600",preserveAspectRatio:"none"},[(0,l._)("path",{fill:"rgb(6, 60, 112)","fill-opacity":"1",d:"M 600 0 Q 550 0 500 300 Q 450 600 0 600 L 600 600 Z"})])],-1))),M={class:"title-text"},q=B((()=>(0,l._)("div",{class:"title-text-up"},"工程监测可视化",-1))),F={class:"title-text-bot"},P=B((()=>(0,l._)("div",{class:"title-wrap-right"},[(0,l._)("svg",{class:"title-svg-right",x:"0",y:"0",width:"100%",height:"100%",viewBox:"0 0 600 600",preserveAspectRatio:"none"},[(0,l._)("path",{fill:"rgb(6, 60, 112)","fill-opacity":"1",d:"M 0 0 Q 50 0 100 300 Q 150 600 600 600 L 0 600 Z"})])],-1))),Q={style:{float:"left"}},J={style:{float:"right",color:"var(--el-text-color-secondary)"}},R={class:"selector-icon-container"},E={class:"content-container"},X={class:"content-container-wrapper"};var $=(0,l.aZ)({__name:"DataView",async setup(e){let t,a;const o=([t,a]=(0,l.mv)((()=>(0,A.AA)())),t=await t,a(),t);console.log("projects",o?.data);let i=(0,r.iH)(o?.data);const s=(0,r.iH)([]);let c=(0,r.iH)(i.value[0]);console.log("pt geojson",([t,a]=(0,l.mv)((()=>(0,A.l1)(c.value.id,"P1"))),t=await t,a(),t));let d=(0,r.iH)(!1),p=()=>{d.value=!d.value};const v=(0,r.iH)(new Date),u=()=>{v.value=new Date};let y,_="0",I=[{chartId:"1",order:"1",styleType:"1"},{chartId:"2",order:"2",styleType:"1"},{chartId:"4",order:"3",styleType:"1"},{chartId:"5",order:"5",styleType:"3"},{chartId:"6",order:"6",styleType:"1"},{chartId:"9",order:"8",styleType:"1"}],g=[{chartId:"78",order:"7",styleType:"1"}],f=()=>{w.ZP.push({path:"/"})};return(0,l.bv)((()=>{y=setInterval(u,1e3)})),(0,l.Ah)((()=>{clearInterval(y)})),(e,t)=>{const a=(0,l.up)("el-option"),o=(0,l.up)("el-select");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",Y,[(0,l._)("div",{class:"logo-text",onClick:t[0]||(t[0]=(...e)=>(0,r.SU)(f)&&(0,r.SU)(f)(...e))},"NHRI"),(0,l._)("div",N,[(0,l._)("p",W,(0,n.zw)(v.value.toLocaleTimeString()),1)]),(0,l._)("div",V,[K,(0,l._)("div",M,[q,(0,l._)("div",F,(0,n.zw)((0,r.SU)(c)?.projectName),1)]),P]),(0,l._)("div",{class:(0,n.C_)(["selector-container",{active:(0,r.SU)(d)}])},[(0,l.Wm)(o,{modelValue:(0,r.SU)(c),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,r.dq)(c)?c.value=e:c=e),"value-key":"id",placeholder:"请选择",size:"large"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(i),(e=>((0,l.wg)(),(0,l.j4)(a,{key:e.id,label:e.projectName,value:e},{default:(0,l.w5)((()=>[(0,l._)("span",Q,(0,n.zw)(e.projectName),1),(0,l._)("span",J,(0,n.zw)(e.time),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])],2),(0,l._)("div",R,[(0,l._)("div",{class:(0,n.C_)(["selector-icon",(0,r.SU)(d)?"squeeze":"expand"]),onClick:t[2]||(t[2]=(...e)=>(0,r.SU)(p)&&(0,r.SU)(p)(...e))},null,2)])]),(0,l._)("div",E,[(0,l._)("div",X,[((0,l.wg)(),(0,l.j4)(l.n4,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(I),((e,t)=>((0,l.wg)(),(0,l.j4)(H,{key:t,chartId:e.chartId,styleType:e.styleType,order:e.order,"project-id":(0,r.SU)(c).id,ref_for:!0,ref_key:"chartConatinerRefs",ref:s},null,8,["chartId","styleType","order","project-id"])))),128))])),_:1})),((0,l.wg)(),(0,l.j4)(l.n4,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(g),((e,t)=>((0,l.wg)(),(0,l.j4)(z,{key:t,chartId:e.chartId,styleType:e.styleType,order:e.order,"project-id":(0,r.SU)(c).id},null,8,["chartId","styleType","order","project-id"])))),128))])),_:1})),((0,l.wg)(),(0,l.j4)(l.n4,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,{mapId:(0,r.SU)(_),order:"4","project-id":(0,r.SU)(c).id},null,8,["mapId","project-id"])])),_:1}))])])],64)}}});const G=(0,m.Z)($,[["__scopeId","data-v-0ce8c526"]]);var ee=G,te=(0,l.aZ)({__name:"DataViewWrapper",setup(e){const t=(0,r.iH)(!0);return(e,a)=>{const r=(0,l.up)("el-skeleton-item"),n=(0,l.up)("el-skeleton");return(0,l.wg)(),(0,l.j4)(l.n4,null,{fallback:(0,l.w5)((()=>[(0,l.Wm)(n,{loading:t.value,animated:"",count:9},{template:(0,l.w5)((()=>[(0,l.Wm)(r,{variant:"rect",style:{width:"33.3vw",height:"33.1vh"}})])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(ee)])),_:1})}}});const ae=(0,m.Z)(te,[["__scopeId","data-v-4dc497fa"]]);var le=ae}}]);
//# sourceMappingURL=708.78ac765d.js.map